{% block stylesheets %}
<link rel="stylesheet" href="{{ asset('css/task.css') }}">
{% endblock %}

{% block body %}
<div class="container">
    <h1>To do List</h1>

    <a href="/logout">Sign Out</a>
</div>
    <a class="task_new"href="{{ path('app_task_new') }}">Create new</a>
    <div class="search-container">
    <input type="text" id="searchInput" placeholder="Rechercher une tÃ¢che..." class="search-input">
    </div>
    <table class="table">
        <thead>
            <tr>
                <th>TITLE</th>
                <th>DESCRIPTION</th>
                <th>DEADLINE</th>
                <th>CATEGORY</th>
                <th>STATUS</th>
                <th>PRIORITY</th>
                <th>ACTIONS</th>
            </tr>
        </thead>
        <tbody id="taskTableBody">
        {% for task in tasks %}
            <tr class="task-row" data-title="{{ task.title }}" data-description="{{ task.description }}" data-category="{{ task.category }}" data-status="{{ task.status }}">
                <td>{{ task.title }}</td>
                <td>{{ task.description }}</td>
                <td>{{ task.deadline ? task.deadline|date('Y-m-d H:i:s') : '' }}</td>
                <td>{{ task.category }}</td>
                <td>{{ task.status }}</td>
                <td>{{ task.priority }}</td>
                <td>
                    <a href="{{ path('app_task_show', {'id': task.id}) }}" class="show">show</a>
                    <a href="{{ path('app_task_edit', {'id': task.id}) }}" class="edit">edit</a>
                </td>
            </tr>
        {% else %}
            <tr>
                <td colspan="7">no records found</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>

<script>
const searchInput = document.getElementById('searchInput');
const rows = document.getElementsByClassName('task-row');

searchInput.addEventListener('input', function() {
    const searchTerm = this.value.toLowerCase().trim();
    
    Array.from(rows).forEach(row => {
        const title = row.getAttribute('data-title').toLowerCase();
        const description = row.getAttribute('data-description').toLowerCase();
        const category = row.getAttribute('data-category').toLowerCase();
        const status = row.getAttribute('data-status').toLowerCase();
        
        const matches = title.includes(searchTerm) || 
                       description.includes(searchTerm) || 
                       category.includes(searchTerm) || 
                       status.includes(searchTerm);
        
        row.style.display = matches ? '' : 'none';
    });
});
</script>
{% endblock %}
